/*!
 * Responsive Tables v5.0.4 (http://gergeo.se/RWD-Table-Patterns)
 * This is an awesome solution for responsive tables with complex data.
 * Authors: Nadan Gergeo <nadan.gergeo@gmail.com> (www.gergeo.se) & Maggie Wachs (www.filamentgroup.com)
 * Licensed under MIT (https://github.com/nadangergeo/RWD-Table-Patterns/blob/master/LICENSE-MIT)
 */
(function(e){var c=function(h,g){var i=this;this.options=g;this.$tableWrapper=null;this.$tableScrollWrapper=e(h);this.$table=e(h).find("table");if(this.$table.length!==1){throw new Error("Exactly one table is expected in a .table-responsive div.")}this.$tableScrollWrapper.attr("data-pattern",this.options.pattern);this.id=this.$table.prop("id")||this.$tableScrollWrapper.prop("id")||"id"+Math.random().toString(16).slice(2);this.$tableClone=null;this.$stickyTableHeader=null;this.$thead=this.$table.find("thead");this.$tbody=this.$table.find("tbody");this.$hdrCells=this.$thead.find("th");this.$bodyRows=this.$tbody.find("tr");this.$btnToolbar=null;this.$dropdownGroup=null;this.$dropdownBtn=null;this.$dropdownContainer=null;this.$displayAllBtn=null;this.$focusGroup=null;this.$focusBtn=null;this.displayAllTrigger="display-all-"+this.id+".responsive-table";this.idPrefix=this.id+"-col-";this.iOS=a();this.wrapTable();this.createButtonToolbar();this.setupHdrCells();this.setupStandardCells();if(this.options.stickyTableHeader){this.createStickyTableHeader()}if(this.$dropdownContainer.is(":empty")){this.$dropdownGroup.hide()}e(window).bind("orientationchange resize "+this.displayAllTrigger,function(){i.$dropdownContainer.find("input").trigger("updateCheck");e.proxy(i.updateSpanningCells(),i)})};c.DEFAULTS={pattern:"priority-columns",stickyTableHeader:true,fixedNavbar:".navbar-fixed-top",addDisplayAllBtn:true,addFocusBtn:false,focusBtnIcon:"glyphicon glyphicon-screenshot"};c.prototype.wrapTable=function(){this.$tableWrapper=this.$tableScrollWrapper.parent()};c.prototype.createButtonToolbar=function(){var g=this;this.$btnToolbar=e(".btn-toolbar");this.$dropdownGroup=e('<div class="btn-group dropdown-btn-group pull-right" />');this.$dropdownBtn=e('<button data-rwd="1" class="btn btn-default dropdown-toggle  waves-effect waves-float" data-toggle="dropdown">'+trans("Display")+' <span class="caret"></span></button>');this.$dropdownContainer=e('<ul class="dropdown-menu"/>');if(this.options.addDisplayAllBtn){this.$displayAllBtn=e('<button data-rwd="2" class="btn btn-default  waves-effect waves-float">'+trans("Display all")+"</button>");e('button[data-rwd="2"]').remove();this.$dropdownGroup.append(this.$displayAllBtn);if(this.$table.hasClass("display-all")){this.$displayAllBtn.addClass("btn-primary")}this.$displayAllBtn.click(function(){e.proxy(g.displayAll(null,true),g)})}e('button[data-rwd="1"]').remove();this.$dropdownGroup.append(this.$dropdownBtn).append(this.$dropdownContainer);this.$btnToolbar.append(this.$dropdownGroup);if(this.$btnToolbar.length<1){this.$tableScrollWrapper.before(this.$btnToolbar)}};c.prototype.displayAll=function(h,g){if(this.$displayAllBtn){this.$displayAllBtn.toggleClass("btn-primary",h)}this.$table.toggleClass("display-all",h);if(this.$tableClone){this.$tableClone.toggleClass("display-all",h)}if(g){e(window).trigger(this.displayAllTrigger)}};c.prototype.preserveDisplayAll=function(){var g="table-cell";if(e("html").hasClass("lt-ie9")){g="inline"}e(this.$table).find("th, td").css("display",g);if(this.$tableClone){e(this.$tableClone).find("th, td").css("display",g)}};c.prototype.createStickyTableHeader=function(){var g=this;g.$tableClone=g.$table.clone();g.$tableClone.prop("id",this.id+"-clone");g.$tableClone.find("[id]").each(function(){e(this).prop("id",e(this).prop("id")+"-clone")});g.$tableClone.wrap('<div class="sticky-table-header"/>');g.$stickyTableHeader=g.$tableClone.parent();g.$stickyTableHeader.css("height",g.$thead.height()+2);if(e("html").hasClass("lt-ie10")){g.$tableWrapper.prepend(g.$stickyTableHeader)}else{g.$table.before(g.$stickyTableHeader)}e(window).bind("scroll resize",function(){e.proxy(g.updateStickyTableHeader(),g)});e(g.$tableScrollWrapper).bind("scroll",function(){e.proxy(g.updateStickyTableHeader(),g)})};c.prototype.updateStickyTableHeader=function(){var l=this,p=0,h=l.$table.offset().top,g=e(window).scrollTop()-1,j=l.$table.height()-l.$stickyTableHeader.height(),i=(g+e(window).height())-e(document).height(),m=!l.iOS,k=0;if(e(l.options.fixedNavbar).length){var n=e(l.options.fixedNavbar).first();k=n.height();g=g+k}var q=(g>h)&&(g<h+l.$table.height());if(m){l.$stickyTableHeader.scrollLeft(l.$tableScrollWrapper.scrollLeft());l.$stickyTableHeader.addClass("fixed-solution");p=k-1;if(((g-h)>j)){p-=((g-h)-j);l.$stickyTableHeader.addClass("border-radius-fix")}else{l.$stickyTableHeader.removeClass("border-radius-fix")}if(q){l.$stickyTableHeader.css({"visibility":"visible","top":p+"px","width":l.$tableScrollWrapper.innerWidth()+"px"});return}else{l.$stickyTableHeader.css({"visibility":"hidden","width":"auto"})}}else{l.$stickyTableHeader.removeClass("fixed-solution");var o=400;p=g-h-1;if(p<0){p=0}else{if(p>j){p=j}}if(i>0){p=p-i}if(q){l.$stickyTableHeader.css({"visibility":"visible"});l.$stickyTableHeader.animate({"top":p+"px"},o);l.$thead.css({"visibility":"hidden"})}else{l.$stickyTableHeader.animate({"top":"0"},o,function(){l.$thead.css({"visibility":"visible"});l.$stickyTableHeader.css({"visibility":"hidden"})})}}};c.prototype.setupHdrCells=function(){var g=this;g.$hdrCells.each(function(j){var l=e(this),n=l.prop("id"),m=l.text();if(!n){n=g.idPrefix+j;l.prop("id",n)}if(m===""){m=l.attr("data-col-name")}if(l.is("[data-priority]")){var h=e('<li class="checkbox-row"><input type="checkbox" name="toggle-'+n+'" id="toggle-'+n+'" value="'+n+'" /> <label for="toggle-'+n+'">'+m+"</label></li>");var k=h.find("input");g.$dropdownContainer.append(h);h.click(function(){k.prop("checked",!k.prop("checked"));k.trigger("change")});if(e("html").hasClass("lt-ie9")){k.click(function(){e(this).trigger("change")})}h.find("label").click(function(i){i.stopPropagation()});h.find("input").click(function(i){i.stopPropagation()}).change(function(){var o=e(this),p=o.val(),i=g.$tableWrapper.find("#"+p+", #"+p+"-clone, [data-columns~="+p+"]");if(g.$table.hasClass("display-all")){e.proxy(g.preserveDisplayAll(),g);g.$table.removeClass("display-all");if(g.$tableClone){g.$tableClone.removeClass("display-all")}g.$displayAllBtn.removeClass("btn-primary")}i.each(function(){var q=e(this);if(o.is(":checked")){if(q.css("display")!=="none"){q.prop("colSpan",parseInt(q.prop("colSpan"))+1)}q.show()}else{if(parseInt(q.prop("colSpan"))>1){q.prop("colSpan",parseInt(q.prop("colSpan"))-1)}else{q.hide()}}})}).bind("updateCheck",function(){if(l.css("display")!=="none"){e(this).prop("checked",true)}else{e(this).prop("checked",false)}}).trigger("updateCheck")}})};c.prototype.setupStandardCells=function(){var g=this;g.$bodyRows.each(function(){var h=0;e(this).find("th, td").each(function(){var o=e(this);var l="";var n=o.prop("colSpan");var j=0;for(var m=h;m<(h+n);m++){l=l+" "+g.idPrefix+m;var i=g.$tableScrollWrapper.find("#"+g.idPrefix+m);var p=i.attr("data-priority");if(p){o.attr("data-priority",p)}if(i.css("display")==="none"){j++}}if(n>1){o.addClass("spn-cell");if(j!==n){o.show()}else{o.hide()}}o.prop("colSpan",Math.max((n-j),1));l=l.substring(1);o.attr("data-columns",l);h=h+n})})};c.prototype.updateSpanningCells=function(){var g=this;g.$table.find(".spn-cell").each(function(){var m=e(this);var j=m.attr("data-columns").split(" ");var l=j.length;var h=0;for(var k=0;k<l;k++){if(e("#"+j[k]).css("display")==="none"){h++}}if(h!==l){m.show()}else{m.hide()}m.prop("colSpan",Math.max((l-h),1))})};var b=e.fn.responsiveTable;e.fn.responsiveTable=function(g){return this.each(function(){var j=e(this);var i=j.data("responsiveTable");var h=e.extend({},c.DEFAULTS,j.data(),typeof g==="object"&&g);if(h.pattern===""){return}if(!i){j.data("responsiveTable",(i=new c(this,h)))}if(typeof g==="string"){i[g]()}})};e.fn.responsiveTable.Constructor=c;e.fn.responsiveTable.noConflict=function(){e.fn.responsiveTable=b;return this};e(document).on("click.dropdown.data-api",".dropdown-menu .checkbox-row",function(g){g.stopPropagation()});function f(){return(typeof window.matchMedia!=="undefined"||typeof window.msMatchMedia!=="undefined"||typeof window.styleMedia!=="undefined")}function d(){return"ontouchstart" in window}function a(){return !!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))}e("html").removeClass("no-js").addClass("js");if(f()){e("html").addClass("mq")}else{e("html").addClass("no-mq")}if(d()){e("html").addClass("touch")}else{e("html").addClass("no-touch")}})(jQuery);