(function(F){var C={messages:{required:"The %s field is required.",matches:"The %s field does not match the %s field.","default":"The %s field is still set to default, please change.",valid_email:"The %s field must contain a valid email address.",valid_emails:"The %s field must contain all valid email addresses.",min_length:"The %s field must be at least %s characters in length.",max_length:"The %s field must not exceed %s characters in length.",exact_length:"The %s field must be exactly %s characters in length.",greater_than:"The %s field must contain a number greater than %s.",less_than:"The %s field must contain a number less than %s.",alpha:"The %s field must only contain alphabetical characters.",alpha_numeric:"The %s field must only contain alpha-numeric characters.",alpha_dash:"The %s field must only contain alpha-numeric characters, underscores, and dashes.",numeric:"The %s field must contain only numbers.",integer:"The %s field must contain an integer.",decimal:"The %s field must contain a decimal number.",is_natural:"The %s field must contain only positive numbers.",is_natural_no_zero:"The %s field must contain a number greater than zero.",valid_ip:"The %s field must contain a valid IP.",valid_base64:"The %s field must contain a base64 string.",valid_credit_card:"The %s field must contain a valid credit card number.",is_file_type:"The %s field must contain only %s files.",valid_url:"The %s field must contain a valid URL.",greater_than_date:"The %s field must contain a more recent date than %s.",less_than_date:"The %s field must contain an older date than %s.",greater_than_or_equal_date:"The %s field must contain a date that's at least as recent as %s.",less_than_or_equal_date:"The %s field must contain a date that's %s or older."},callback:function(a){}};var z=/^(.+?)\[(.+)\]$/,J=/^[0-9]+$/,L=/^\-?[0-9]+$/,t=/^\-?[0-9]*\.?[0-9]+$/,y=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,K=/^[a-z]+$/i,A=/^[a-z0-9]+$/i,x=/^[a-z0-9_\-]+$/i,w=/^[0-9]+$/i,B=/^[1-9][0-9]*$/i,u=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,D=/[^a-zA-Z0-9\/\+=]/i,G=/^[\d\-\s]+$/,I=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,E=/\d{4}-\d{1,2}-\d{1,2}/;var v=function(j,f,a,d){this.callback=a||C.callback;this.validateCall=d||null;this.errors=[];this.fields={};this.form=this._formByNameOrNode(j)||{};this.messages={};this.handlers={};this.conditionals={};for(var g=0,h=f.length;g<h;g++){var b=f[g];if((!b.name&&!b.names)||!b.rules){console.warn("validate.js: The following field is being skipped due to a misconfiguration:");console.warn(b);console.warn("Check to ensure you have properly configured a name and rules for this field");continue}if(b.names){for(var i=0,c=b.names.length;i<c;i++){this._addField(b,b.names[i])}}else{this._addField(b,b.name)}}var e=this.form.onsubmit;this.form.onsubmit=(function(k){return function(m){try{return k._validateForm(m)&&(e===F||e())}catch(l){}}})(this)},H=function(a,c){var b;if((a.length>0)&&(a[0].type==="radio"||a[0].type==="checkbox")){for(b=0,elementLength=a.length;b<elementLength;b++){if(a[b].checked){return a[b][c]}}return}return a[c]};v.prototype.setMessage=function(a,b){this.messages[a]=b;return this};v.prototype.registerCallback=function(b,a){if(b&&typeof b==="string"&&a&&typeof a==="function"){this.handlers[b]=a}return this};v.prototype.registerConditional=function(a,b){if(a&&typeof a==="string"&&b&&typeof b==="function"){this.conditionals[a]=b}return this};v.prototype._formByNameOrNode=function(a){return(typeof a==="object")?a:document.forms[a]};v.prototype._addField=function(a,b){this.fields[b]={name:b,display:a.display||b,rules:a.rules,depends:a.depends,id:null,element:null,type:null,value:null,checked:null}};v.prototype._validateForm=function(e){this.errors=[];for(var c in this.fields){if(this.fields.hasOwnProperty(c)){var a=this.fields[c]||{},d=this.form[a.name];if(d&&d!==F){a.id=H(d,"id");a.element=d;a.type=(d.length>0)?d[0].type:d.type;a.value=H(d,"value");a.checked=H(d,"checked");var b;if(a.depends&&typeof a.depends==="function"){if(a.depends.call(this,a)){b=this._validateField(a)}}else{if(a.depends&&typeof a.depends==="string"&&this.conditionals[a.depends]){if(this.conditionals[a.depends].call(this,a)){b=this._validateField(a)}}else{b=this._validateField(a)}}typeof this.validateCall!="function"||this.validateCall(a,b)}}}if(typeof this.callback==="function"){this.callback(this.errors,e)}if(this.errors.length>0){if(e&&e.preventDefault){e.preventDefault()}else{if(event){event.returnValue=false}}}return true};v.prototype._validateField=function(n){var c,e,m=n.rules.split("|"),i=n.rules.indexOf("required"),d=(!n.value||n.value===""||n.value===F);for(c=0,ruleLength=m.length;c<ruleLength;c++){var k=m[c],g=null,b=false,f=z.exec(k);if(i===-1&&k.indexOf("!callback_")===-1&&d){continue}if(f){k=f[1];g=f[2]}if(k.charAt(0)==="!"){k=k.substring(1,k.length)}if(typeof this._hooks[k]==="function"){if(!this._hooks[k].apply(this,[n,g])){b=true}}else{if(k.substring(0,9)==="callback_"){k=k.substring(9,k.length);if(typeof this.handlers[k]==="function"){if(this.handlers[k].apply(this,[n.value,g,n])===false){b=true}}}}if(b){var l=this.messages[n.name+"."+k]||this.messages[k]||C.messages[k],j="An error has occurred with the "+n.display+" field.";if(l){j=l.replace("%s",n.display);if(g){j=j.replace("%s",(this.fields[g])?this.fields[g].display:g)}}var a;for(e=0;e<this.errors.length;e+=1){if(n.id===this.errors[e].id){a=this.errors[e]}}var h={id:n.id,display:n.display,element:n.element,name:n.name,message:j,messages:[],rule:k};h.messages.push(j);if(!a){this.errors.push(h)}return h}}};v.prototype._getValidDate=function(b){if(!b.match("today")&&!b.match(E)){return false}var c=new Date(),a;if(!b.match("today")){a=b.split("-");c.setFullYear(a[0]);c.setMonth(a[1]-1);c.setDate(a[2])}return c};v.prototype._hooks={required:function(a){var b=a.value;if((a.type==="checkbox")||(a.type==="radio")){return(a.checked===true)}return(b!==null&&b!=="")},"default":function(a,b){return a.value!==b},matches:function(a,b){var c=this.form[b];if(c){return a.value===c.value}return false},valid_email:function(a){return y.test(a.value)},valid_emails:function(b){var d=b.value.split(/\s*,\s*/g);for(var c=0,a=d.length;c<a;c++){if(!y.test(d[c])){return false}}return true},min_length:function(a,b){if(!J.test(b)){return false}return(a.value.length>=parseInt(b,10))},max_length:function(a,b){if(!J.test(b)){return false}return(a.value.length<=parseInt(b,10))},exact_length:function(a,b){if(!J.test(b)){return false}return(a.value.length===parseInt(b,10))},greater_than:function(b,a){if(!t.test(b.value)){return false}return(parseFloat(b.value)>parseFloat(a))},less_than:function(b,a){if(!t.test(b.value)){return false}return(parseFloat(b.value)<parseFloat(a))},alpha:function(a){return(K.test(a.value))},alpha_numeric:function(a){return(A.test(a.value))},alpha_dash:function(a){return(x.test(a.value))},numeric:function(a){return(J.test(a.value))},integer:function(a){return(L.test(a.value))},decimal:function(a){return(t.test(a.value))},is_natural:function(a){return(w.test(a.value))},is_natural_no_zero:function(a){return(B.test(a.value))},valid_ip:function(a){return(u.test(a.value))},valid_base64:function(a){return(D.test(a.value))},valid_url:function(a){return(I.test(a.value))},valid_credit_card:function(a){if(!G.test(a.value)){return false}var g=0,b=0,e=false;var d=a.value.replace(/\D/g,"");for(var f=d.length-1;f>=0;f--){var c=d.charAt(f);b=parseInt(c,10);if(e){if((b*=2)>9){b-=9}}g+=b;e=!e}return(g%10)===0},is_file_type:function(g,b){if(g.type!=="file"){return true}var c=g.value.substr((g.value.lastIndexOf(".")+1)),f=b.split(","),a=false,d=0,e=f.length;for(d;d<e;d++){if(c.toUpperCase()==f[d].toUpperCase()){a=true}}return a},greater_than_date:function(b,c){var a=this._getValidDate(b.value),d=this._getValidDate(c);if(!d||!a){return false}return a>d},less_than_date:function(b,c){var a=this._getValidDate(b.value),d=this._getValidDate(c);if(!d||!a){return false}return a<d},greater_than_or_equal_date:function(b,c){var a=this._getValidDate(b.value),d=this._getValidDate(c);if(!d||!a){return false}return a>=d},less_than_or_equal_date:function(b,c){var a=this._getValidDate(b.value),d=this._getValidDate(c);if(!d||!a){return false}return a<=d}};window.FormValidator=v})();if(typeof module!=="undefined"&&module.exports){module.exports=FormValidator};